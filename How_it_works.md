# ğŸ”§ How It Works - ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ WOXLY

## ğŸ“‹ Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ

1. [ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹](#-Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°-ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹)
2. [Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ](#-Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ-Ğ¸-Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ)
3. [Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ´Ñ€ÑƒĞ·ĞµĞ¹](#-ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°-Ğ´Ñ€ÑƒĞ·ĞµĞ¹)
4. [ĞšĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹](#-ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹)
5. [Ğ“Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ°Ñ ÑĞ²ÑĞ·ÑŒ (WebRTC)](#-Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ°Ñ-ÑĞ²ÑĞ·ÑŒ-webrtc)
6. [Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ñ‡Ğ°Ñ‚](#-Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹-Ñ‡Ğ°Ñ‚)
7. [Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹](#-ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹-Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹)
8. [Ğ—Ğ²Ğ¾Ğ½ĞºĞ¸](#-Ğ·Ğ²Ğ¾Ğ½ĞºĞ¸)
9. [Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ](#-ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ)
10. [ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ](#-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ-ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ)

---

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### ĞĞ±Ñ‰Ğ°Ñ ÑÑ…ĞµĞ¼Ğ°:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONTEND (React)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   UI     â”‚  â”‚  State   â”‚  â”‚ WebRTC   â”‚  â”‚ Socket   â”‚   â”‚
â”‚  â”‚Componentsâ”‚  â”‚ Manager  â”‚  â”‚ Manager  â”‚  â”‚ Manager  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                â”‚                â”‚            â”‚
         â”‚ REST API       â”‚ WebSocket      â”‚ WebRTC     â”‚
         â–¼                â–¼                â–¼            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Node.js)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚   API    â”‚  â”‚ Socket.IOâ”‚  â”‚   Auth   â”‚                 â”‚
â”‚  â”‚  Server  â”‚  â”‚  Server  â”‚  â”‚  (JWT)   â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DATABASE (PostgreSQL)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Users   â”‚  â”‚ Friends  â”‚  â”‚  Rooms   â”‚  â”‚ Messages â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ¢Ğ¸Ğ¿Ñ‹ ĞºĞ¾Ğ¼Ğ¼ÑƒĞ½Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸:

1. **REST API** - Ğ´Ğ»Ñ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹ Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ (CRUD)
2. **WebSocket** - Ğ´Ğ»Ñ real-time ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ (ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹, ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ)
3. **WebRTC** - Ğ´Ğ»Ñ Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğ¹ ÑĞ²ÑĞ·Ğ¸ P2P (Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸)

---

## ğŸ” Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

### 1. ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸

**Flow Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°:**

```
ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ                Frontend              Backend              Database
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚ 1. Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ Ñ„Ğ¾Ñ€Ğ¼Ñƒ       â”‚                     â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚ 2. ĞĞ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ "Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ"â”‚                     â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚ 3. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… â”‚                     â”‚
    â”‚                          â”‚     (frontend)      â”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚ 4. POST /api/auth/register                â”‚
    â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 5. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ        â”‚
    â”‚                          â”‚                     â”‚    (backend)        â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 6. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°         â”‚
    â”‚                          â”‚                     â”‚    ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸     â”‚
    â”‚                          â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                          â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 7. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ WX ID  â”‚
    â”‚                          â”‚                     â”‚    (WX + 4 Ñ†Ğ¸Ñ„Ñ€Ñ‹)   â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 8. Ğ¥ĞµÑˆ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ       â”‚
    â”‚                          â”‚                     â”‚    (bcrypt)         â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 9. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ·ĞµÑ€Ğ°   â”‚
    â”‚                          â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                          â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 10. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ JWT   â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚ 11. ĞÑ‚Ğ²ĞµÑ‚           â”‚                     â”‚
    â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
    â”‚                          â”‚ {user, token}       â”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚ 12. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ      â”‚                     â”‚
    â”‚                          â”‚     Ñ‚Ğ¾ĞºĞµĞ½Ğ°          â”‚                     â”‚
    â”‚                          â”‚     Ğ² localStorage  â”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚ 13. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ     â”‚                     â”‚
    â”‚                          â”‚     WebSocket       â”‚                     â”‚
    â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚ 14. Ğ ĞµĞ´Ğ¸Ñ€ĞµĞºÑ‚ Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµâ”‚                     â”‚                     â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                     â”‚
```

### 2. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸

**Frontend Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ (Ğ´Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸):**

```typescript
const validateRegistration = () => {
  const errors: string[] = [];
  
  // Username
  if (!username || username.length === 0) {
    errors.push('Username Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ĞµĞ½');
  }
  if (username.length > 13) {
    errors.push('Username Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 13 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²');
  }
  // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±ÑƒĞºĞ²Ñ‹ (Ñ€ÑƒÑ/Ğ°Ğ½Ğ³Ğ»), Ñ†Ğ¸Ñ„Ñ€Ñ‹, Ñ‚Ğ¾Ñ‡ĞºĞ°, Ğ¿Ğ¾Ğ´Ñ‡ĞµÑ€ĞºĞ¸Ğ²Ğ°Ğ½Ğ¸Ğµ
  if (!/^[a-zA-ZĞ°-ÑĞ-Ğ¯0-9._]+$/.test(username)) {
    errors.push('Username Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±ÑƒĞºĞ²Ñ‹, Ñ†Ğ¸Ñ„Ñ€Ñ‹, . Ğ¸ _');
  }
  
  // Email
  if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
    errors.push('ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ email');
  }
  
  // ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ
  if (!password || password.length < 8) {
    errors.push('ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 8 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²');
  }
  
  return errors;
};
```

**Backend Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ:**

```javascript
// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ username
const existingUsername = await db.query(
  'SELECT id FROM users WHERE username = $1',
  [username]
);

if (existingUsername.rows.length > 0) {
  return res.status(400).json({ error: 'Username Ğ·Ğ°Ğ½ÑÑ‚' });
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ email
const existingEmail = await db.query(
  'SELECT id FROM users WHERE email = $1',
  [email]
);

if (existingEmail.rows.length > 0) {
  return res.status(400).json({ error: 'Email ÑƒĞ¶Ğµ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½' });
}
```

### 3. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ WOXLY ID

**Ğ›Ğ¾Ğ³Ğ¸ĞºĞ°:**

```javascript
async function generateWoxlyId() {
  let isUnique = false;
  let woxlyId;
  
  while (!isUnique) {
    // Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ 4 ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ñ… Ñ†Ğ¸Ñ„Ñ€ (1000-9999)
    const randomNum = Math.floor(1000 + Math.random() * 9000);
    woxlyId = `WX${randomNum}`;
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
    const existing = await db.query(
      'SELECT id FROM users WHERE woxly_id = $1',
      [woxlyId]
    );
    
    isUnique = existing.rows.length === 0;
  }
  
  return woxlyId;
}
```

**ĞÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸:**
- âœ… Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: `WX` + 4 Ñ†Ğ¸Ñ„Ñ€Ñ‹ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: `WX1234`)
- âœ… Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€Ğ¸ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸
- âœ… **ĞĞµĞ»ÑŒĞ·Ñ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ** Ğ¿Ğ¾ÑĞ»Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ
- âœ… Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¸ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
- âœ… Ğ’ÑĞµĞ³Ğ´Ğ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹

### 4. ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

**Flow:**

```
ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ                Frontend              Backend              Database
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚ 1. Ğ’Ğ²Ğ¾Ğ´ email/username   â”‚                     â”‚                     â”‚
    â”‚    Ğ¸ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ              â”‚                     â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚ 2. POST /api/auth/login  â”‚                     â”‚                     â”‚
    â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 3. ĞŸĞ¾Ğ¸ÑĞº ÑĞ·ĞµÑ€Ğ°      â”‚
    â”‚                          â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                          â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 4. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ  â”‚
    â”‚                          â”‚                     â”‚    (bcrypt.compare) â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 5. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ  â”‚
    â”‚                          â”‚                     â”‚    Ğ½Ğ° "online"      â”‚
    â”‚                          â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 6. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ JWT    â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚ 7. ĞÑ‚Ğ²ĞµÑ‚           â”‚                     â”‚
    â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚ 8. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ğ°â”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚ 9. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ WS   â”‚                     â”‚
    â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
    â”‚                          â”‚                     â”‚                     â”‚
    â”‚                          â”‚                     â”‚ 10. Broadcast       â”‚
    â”‚                          â”‚                     â”‚     "user online"   â”‚
    â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
    â”‚ 11. Ğ’Ñ…Ğ¾Ğ´ Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ    â”‚                     â”‚                     â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                     â”‚
```

---

## ğŸ‘¥ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ´Ñ€ÑƒĞ·ĞµĞ¹

### 1. ĞšĞ°Ğº Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ°

**Flow:**

```
User A                      Frontend A            Backend              Frontend B            User B
  â”‚                            â”‚                     â”‚                     â”‚                   â”‚
  â”‚ 1. ĞŸĞ¾Ğ¸ÑĞº "ivan" Ğ¸Ğ»Ğ¸ "WX1234"                     â”‚                     â”‚                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚                   â”‚
  â”‚                            â”‚                     â”‚                     â”‚                   â”‚
  â”‚                            â”‚ 2. GET /api/users/search?q=ivan           â”‚                   â”‚
  â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                   â”‚
  â”‚                            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                   â”‚
  â”‚                            â”‚ [{id, username...}] â”‚                     â”‚                   â”‚
  â”‚                            â”‚                     â”‚                     â”‚                   â”‚
  â”‚ 3. Ğ’Ğ¸Ğ´Ğ¸Ñ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²â”‚                     â”‚                     â”‚                   â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                     â”‚                   â”‚
  â”‚                            â”‚                     â”‚                     â”‚                   â”‚
  â”‚ 4. ĞšĞ»Ğ¸Ğº "Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ"         â”‚                     â”‚                     â”‚                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚                   â”‚
  â”‚                            â”‚                     â”‚                     â”‚                   â”‚
  â”‚                            â”‚ 5. POST /api/friends/add                  â”‚                   â”‚
  â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                   â”‚
  â”‚                            â”‚                     â”‚                     â”‚                   â”‚
  â”‚                            â”‚                     â”‚ 6. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°:        â”‚                   â”‚
  â”‚                            â”‚                     â”‚    - ÑĞ·ĞµÑ€ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚â”‚                   â”‚
  â”‚                            â”‚                     â”‚    - Ğ½Ğµ ÑĞµĞ±Ñ        â”‚                   â”‚
  â”‚                            â”‚                     â”‚    - ĞµÑ‰Ñ‘ Ğ½Ğµ Ğ´Ñ€ÑƒĞ·ÑŒÑ  â”‚                   â”‚
  â”‚                            â”‚                     â”‚                     â”‚                   â”‚
  â”‚                            â”‚                     â”‚ 7. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ² Ğ‘Ğ”  â”‚                   â”‚
  â”‚                            â”‚                     â”‚                     â”‚                   â”‚
  â”‚                            â”‚                     â”‚ 8. WebSocket emit   â”‚                   â”‚
  â”‚                            â”‚                     â”‚    "friend-request" â”‚                   â”‚
  â”‚                            â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
  â”‚                            â”‚                     â”‚                     â”‚                   â”‚
  â”‚                            â”‚                     â”‚                     â”‚ 9. Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ    â”‚
  â”‚                            â”‚                     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                            â”‚                     â”‚                     â”‚ "ivan Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ğ»    â”‚
  â”‚                            â”‚                     â”‚                     â”‚  Ğ²Ğ°Ñ Ğ² Ğ´Ñ€ÑƒĞ·ÑŒÑ"   â”‚
  â”‚ 10. "ivan Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½"        â”‚                     â”‚                     â”‚                   â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                     â”‚                   â”‚
```

### 2. Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ´Ñ€ÑƒĞ·ĞµĞ¹ - ĞºĞ°Ğº Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ

**SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ:**

```sql
SELECT 
  u.id,
  u.woxly_id,
  u.username,
  u.avatar_url,
  u.status,           -- online/offline/busy/away
  f.note,             -- ĞŸĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºĞ°
  f.created_at        -- ĞšĞ¾Ğ³Ğ´Ğ° Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ Ğ² Ğ´Ñ€ÑƒĞ·ÑŒÑ
FROM friends f
JOIN users u ON (
  -- Ğ”Ñ€ÑƒĞ·ÑŒÑ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ² Ğ»ÑĞ±Ğ¾Ğ¹ ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞµ
  CASE 
    WHEN f.user_id = $1 THEN u.id = f.friend_id
    ELSE u.id = f.user_id
  END
)
WHERE f.user_id = $1 OR f.friend_id = $1
ORDER BY u.status DESC, u.username ASC;
```

**Frontend Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ:**

```typescript
// Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ´Ñ€ÑƒĞ·ĞµĞ¹ Ğ¿Ğ¾ ÑÑ‚Ğ°Ñ‚ÑƒÑÑƒ
const groupedFriends = {
  online: friends.filter(f => f.status === 'online'),
  offline: friends.filter(f => f.status === 'offline'),
  busy: friends.filter(f => f.status === 'busy'),
  away: friends.filter(f => f.status === 'away')
};

// Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ Ğ³Ñ€ÑƒĞ¿Ğ¿ Ğ¿Ğ¾ username
Object.keys(groupedFriends).forEach(status => {
  groupedFriends[status].sort((a, b) => 
    a.username.localeCompare(b.username)
  );
});
```

### 3. ĞŸĞ¾Ğ¸ÑĞº Ğ´Ñ€ÑƒĞ·ĞµĞ¹

**Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿Ğ¾Ğ¸ÑĞºĞ°:**

```javascript
// Backend: Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾ username Ğ˜Ğ›Ğ˜ woxly_id
router.get('/search', authMiddleware, async (req, res) => {
  const { q } = req.query;
  const userId = req.userId;
  
  // ĞœĞ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 2 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ° Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
  if (!q || q.length < 2) {
    return res.status(400).json({ error: 'Ğ¡Ğ»Ğ¸ÑˆĞºĞ¾Ğ¼ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ' });
  }
  
  const result = await db.query(
    `SELECT 
      id, 
      woxly_id, 
      username, 
      avatar_url, 
      status,
      -- ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑƒĞ¶Ğµ Ğ´Ñ€ÑƒĞ·ÑŒÑ Ğ¸Ğ»Ğ¸ Ğ½ĞµÑ‚
      EXISTS(
        SELECT 1 FROM friends 
        WHERE (user_id = $2 AND friend_id = users.id)
           OR (user_id = users.id AND friend_id = $2)
      ) as is_friend
     FROM users
     WHERE (
       username ILIKE $1        -- ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ username (Ğ½Ğµ Ñ‡ÑƒĞ²ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğº Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñƒ)
       OR woxly_id = $3          -- Ğ¢Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾ WOXLY ID
     )
     AND id != $2                -- Ğ˜ÑĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ ÑĞµĞ±Ñ
     LIMIT 20`,
    [`%${q}%`, userId, q.toUpperCase()]
  );
  
  res.json({ users: result.rows });
});
```

**Frontend debounce Ğ¿Ğ¾Ğ¸ÑĞºĞ°:**

```typescript
// ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ 300Ğ¼Ñ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ°
const debouncedSearch = useCallback(
  debounce(async (query: string) => {
    if (query.length < 2) {
      setSearchResults([]);
      return;
    }
    
    const response = await fetch(
      `/api/users/search?q=${encodeURIComponent(query)}`,
      { headers: { 'Authorization': `Bearer ${token}` } }
    );
    
    const data = await response.json();
    setSearchResults(data.users);
  }, 300),
  []
);
```

---

## ğŸ  ĞšĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹

### 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹

**Flow:**

```
User (Owner)              Frontend              Backend              Database
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚ 1. ĞšĞ»Ğ¸Ğº "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ       â”‚                     â”‚                     â”‚
    â”‚    ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ"            â”‚                     â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚ 2. ĞœĞ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾:     â”‚                     â”‚                     â”‚
    â”‚    - ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ          â”‚                     â”‚                     â”‚
    â”‚    - ĞŸÑ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ğ°Ñ?        â”‚                     â”‚                     â”‚
    â”‚    - Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ´Ñ€ÑƒĞ·ĞµĞ¹      â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚ 3. ĞĞ°Ğ¶Ğ°Ñ‚ÑŒ "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ"    â”‚                     â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚ 4. POST /api/rooms  â”‚                     â”‚
    â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
    â”‚                        â”‚ {                   â”‚                     â”‚
    â”‚                        â”‚   name: "Ğ˜Ğ³Ñ€Ñ‹",     â”‚                     â”‚
    â”‚                        â”‚   isPrivate: true,  â”‚                     â”‚
    â”‚                        â”‚   invitedFriends: [2,5,7]                 â”‚
    â”‚                        â”‚ }                   â”‚                     â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚ 5. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ  â”‚
    â”‚                        â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                        â”‚                     â”‚ INSERT INTO rooms   â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚ 6. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ²Ğ»Ğ°Ğ´ĞµĞ»ÑŒÑ†Ğ°â”‚
    â”‚                        â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                        â”‚                     â”‚ INSERT INTO         â”‚
    â”‚                        â”‚                     â”‚ room_participants   â”‚
    â”‚                        â”‚                     â”‚ (status='accepted') â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚ 7. ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ·ĞµĞ¹â”‚
    â”‚                        â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                        â”‚                     â”‚ INSERT INTO         â”‚
    â”‚                        â”‚                     â”‚ room_participants   â”‚
    â”‚                        â”‚                     â”‚ (status='pending')  â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚ 8. WebSocket:       â”‚
    â”‚                        â”‚                     â”‚    ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ        â”‚
    â”‚                        â”‚                     â”‚    Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ñ      â”‚
    â”‚                        â”‚                     â”‚    Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼          â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚ 9. ĞÑ‚Ğ²ĞµÑ‚           â”‚                     â”‚
    â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
    â”‚                        â”‚ { room }            â”‚                     â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚ 10. ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ²Ñ…Ğ¾Ğ´â”‚                     â”‚                     â”‚
    â”‚     Ğ² ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ          â”‚                     â”‚                     â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                     â”‚
```

### 2. Ğ¢Ğ¸Ğ¿Ñ‹ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚

**ĞŸÑ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ°:**

```typescript
interface PrivateRoom {
  id: number;
  name: string;
  ownerId: number;
  isPrivate: true;
  
  // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆÑ‘Ğ½Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ²Ğ¾Ğ¹Ñ‚Ğ¸
  participants: {
    userId: number;
    status: 'pending' | 'accepted' | 'declined';
  }[];
}
```

**ĞŸÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ° (Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ² WOXLY, Ğ½Ğ¾ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾):**

```typescript
interface PublicRoom {
  id: number;
  name: string;
  ownerId: number;
  isPrivate: false;
  
  // Ğ›ÑĞ±Ğ¾Ğ¹ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²Ğ¾Ğ¹Ñ‚Ğ¸
  maxParticipants?: number;
}
```

### 3. ĞŸÑ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ Ğº ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğµ

**Flow Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆÑ‘Ğ½Ğ½Ğ¾Ğ³Ğ¾:**

```
User (Invited)            Frontend              Backend              Database
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚ 1. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ           â”‚                     â”‚                     â”‚
    â”‚    ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ         â”‚                     â”‚                     â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ WebSocket:          â”‚                     â”‚
    â”‚    "Ğ˜Ğ²Ğ°Ğ½ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ»     â”‚ "room-invitation"   â”‚                     â”‚
    â”‚     Ğ²Ğ°Ñ Ğ² ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ"     â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚ 2. ĞšĞ»Ğ¸Ğº "ĞŸÑ€Ğ¸Ğ½ÑÑ‚ÑŒ"      â”‚                     â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚ 3. POST /api/rooms/:id/join               â”‚
    â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚ 4. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°:        â”‚
    â”‚                        â”‚                     â”‚    - ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ° ĞµÑÑ‚ÑŒ   â”‚
    â”‚                        â”‚                     â”‚    - ĞµÑÑ‚ÑŒ Ğ² ÑĞ¿Ğ¸ÑĞºĞµ  â”‚
    â”‚                        â”‚                     â”‚      ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²     â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚ 5. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ  â”‚
    â”‚                        â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                        â”‚                     â”‚ UPDATE              â”‚
    â”‚                        â”‚                     â”‚ room_participants   â”‚
    â”‚                        â”‚                     â”‚ SET status='accepted'â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚ 6. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº  â”‚
    â”‚                        â”‚                     â”‚    ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²       â”‚
    â”‚                        â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                        â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚                     â”‚ 7. WebSocket:       â”‚
    â”‚                        â”‚                     â”‚    Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ Ğ²ÑĞµÑ…   â”‚
    â”‚                        â”‚                     â”‚    Ğ² ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğµ        â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚                        â”‚ 8. ĞÑ‚Ğ²ĞµÑ‚           â”‚                     â”‚
    â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
    â”‚                        â”‚ { room, participants }                    â”‚
    â”‚                        â”‚                     â”‚                     â”‚
    â”‚ 9. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº       â”‚                     â”‚                     â”‚
    â”‚    Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğ¼Ñƒ Ñ‡Ğ°Ñ‚Ñƒ     â”‚                     â”‚                     â”‚
    â”‚    (WebRTC)            â”‚                     â”‚                     â”‚
```

### 4. ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²

**Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ:**

```typescript
interface ParticipantDisplay {
  id: number;
  woxlyId: string;
  username: string;
  avatar: string;
  
  // Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
  isOnline: boolean;        // ĞĞ½Ğ»Ğ°Ğ¹Ğ½ Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸
  isInRoom: boolean;        // Ğ’ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğµ ÑĞµĞ¹Ñ‡Ğ°Ñ
  isSpeaking: boolean;      // Ğ“Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ñ‚ Ğ¿Ñ€ÑĞ¼Ğ¾ ÑĞµĞ¹Ñ‡Ğ°Ñ
  isMuted: boolean;         // ĞœĞ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½ Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½
  isDeafened: boolean;      // Ğ—Ğ²ÑƒĞº Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½
  
  // Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹
  statusColor: string;      // Ğ—ĞµĞ»Ñ‘Ğ½Ñ‹Ğ¹/ÑĞµÑ€Ñ‹Ğ¹/ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹
  speakingAnimation: boolean; // ĞŸÑƒĞ»ÑŒÑĞ°Ñ†Ğ¸Ñ Ñ€Ğ¾Ğ·Ğ¾Ğ²Ñ‹Ğ¼
}

// Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²
const sortParticipants = (participants: Participant[]) => {
  return participants.sort((a, b) => {
    // 1. Ğ“Ğ¾Ğ²Ğ¾Ñ€ÑÑ‰Ğ¸Ğµ Ğ²Ğ²ĞµÑ€Ñ…Ñƒ
    if (a.isSpeaking && !b.isSpeaking) return -1;
    if (!a.isSpeaking && b.isSpeaking) return 1;
    
    // 2. ĞĞ½Ğ»Ğ°Ğ¹Ğ½ Ğ²Ñ‹ÑˆĞµ Ğ¾Ñ„Ğ»Ğ°Ğ¹Ğ½
    if (a.isInRoom && !b.isInRoom) return -1;
    if (!a.isInRoom && b.isInRoom) return 1;
    
    // 3. ĞŸĞ¾ Ğ°Ğ»Ñ„Ğ°Ğ²Ğ¸Ñ‚Ñƒ
    return a.username.localeCompare(b.username);
  });
};
```

**Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹:**

```typescript
// Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½ - Ğ·ĞµĞ»Ñ‘Ğ½Ğ°Ñ Ñ‚Ğ¾Ñ‡ĞºĞ°
<div className="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-[#0a0a0a]" />

// Ğ“Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ñ‚ - Ñ€Ğ¾Ğ·Ğ¾Ğ²Ğ°Ñ Ğ¿ÑƒĞ»ÑŒÑĞ°Ñ†Ğ¸Ñ
<motion.div
  className="absolute -inset-1 bg-primary/20 rounded-full"
  animate={{ scale: [1, 1.2, 1], opacity: [0.5, 0.8, 0.5] }}
  transition={{ duration: 1, repeat: Infinity }}
/>

// ĞœĞ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½ Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½ - Ğ¸ĞºĞ¾Ğ½ĞºĞ°
{isMuted && (
  <div className="absolute top-0 right-0 bg-red-500 rounded-full p-1">
    <MicOff className="w-3 h-3 text-white" />
  </div>
)}
```

---

## ğŸ™ï¸ Ğ“Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ°Ñ ÑĞ²ÑĞ·ÑŒ (WebRTC)

### 1. ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ flow Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ

```
User A                    Frontend A              Signaling Server        Frontend B                User B
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚ 1. Ğ’Ñ…Ğ¾Ğ´ Ğ² ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ        â”‚                           â”‚                      â”‚                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚ 2. Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½Ğ°       â”‚                      â”‚                       â”‚
  â”‚                          â”‚    getUserMedia()         â”‚                      â”‚                       â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ "Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿?"       â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚ 3. Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ¸Ñ‚ÑŒ             â”‚                           â”‚                      â”‚                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚ 4. socket.emit('join-room')                      â”‚                       â”‚
  â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚ 5. Broadcast         â”‚                       â”‚
  â”‚                          â”‚                           â”‚   'user-joined-room' â”‚                       â”‚
  â”‚                          â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚ 6. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ           â”‚
  â”‚                          â”‚                           â”‚                      â”‚    RTCPeerConnection â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚ 7. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ offer     â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚ 8. socket.emit       â”‚                       â”‚
  â”‚                          â”‚                           â”‚    'webrtc-offer'    â”‚                       â”‚
  â”‚                          â”‚                           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚ 9. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ offer         â”‚                      â”‚                       â”‚
  â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚ 10. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ               â”‚                      â”‚                       â”‚
  â”‚                          â”‚     RTCPeerConnection     â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚ 11. setRemoteDescription  â”‚                      â”‚                       â”‚
  â”‚                          â”‚     (offer)               â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚ 12. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ answer        â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚ 13. socket.emit           â”‚                      â”‚                       â”‚
  â”‚                          â”‚     'webrtc-answer'       â”‚                      â”‚                       â”‚
  â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚ 14. ĞŸĞµÑ€ĞµÑĞ»Ğ°Ñ‚ÑŒ answer â”‚                       â”‚
  â”‚                          â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚ 15. setRemoteDescriptionâ”‚
  â”‚                          â”‚                           â”‚                      â”‚     (answer)          â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚ 16. ĞĞ±Ğ¼ĞµĞ½ ICE candidates  â”‚                      â”‚                       â”‚
  â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚                          â”‚ 17. P2P CONNECTION ESTABLISHED                   â”‚                       â”‚
  â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚
  â”‚                          â”‚        (Ğ³Ğ¾Ğ»Ğ¾Ñ Ğ¸Ğ´Ñ‘Ñ‚ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ!)                    â”‚                       â”‚
  â”‚                          â”‚                           â”‚                      â”‚                       â”‚
  â”‚ 18. Ğ¡Ğ»Ñ‹ÑˆĞ¸Ğ¼ Ğ´Ñ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ°    â”‚                           â”‚                      â”‚ 19. Ğ¡Ğ»Ñ‹ÑˆĞ¸Ğ¼ Ğ´Ñ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ° â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
```

### 2. ĞšĞ¾Ğ´ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğ¼Ñƒ Ñ‡Ğ°Ñ‚Ñƒ

**Frontend:**

```typescript
class VoiceManager {
  private peers: Map<number, RTCPeerConnection> = new Map();
  private localStream: MediaStream | null = null;
  private socket: Socket;
  
  async joinVoiceChat(roomId: number) {
    // 1. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½Ñƒ
    try {
      this.localStream = await navigator.mediaDevices.getUserMedia({
        audio: {
          echoCancellation: true,      // ĞŸĞ¾Ğ´Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ…Ğ°
          noiseSuppression: true,       // ĞŸĞ¾Ğ´Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑˆÑƒĞ¼Ğ°
          autoGainControl: true,        // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ€ĞµĞ³ÑƒĞ»Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ³Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚Ğ¸
          sampleRate: 48000,            // ĞšĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ·Ğ²ÑƒĞºĞ°
          channelCount: 1               // ĞœĞ¾Ğ½Ğ¾
        }
      });
    } catch (error) {
      console.error('ĞœĞ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½:', error);
      return;
    }
    
    // 2. ĞŸÑ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒÑÑ Ğº Socket.IO ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğµ
    this.socket.emit('join-room', roomId);
    
    // 3. Ğ¡Ğ»ÑƒÑˆĞ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ñ… ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²
    this.socket.on('user-joined-room', ({ userId }) => {
      this.createPeerConnection(userId, true);
    });
    
    // 4. Ğ¡Ğ»ÑƒÑˆĞ°Ñ‚ÑŒ WebRTC ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ñ‹
    this.socket.on('webrtc-offer', ({ from, offer }) => {
      this.handleOffer(from, offer);
    });
    
    this.socket.on('webrtc-answer', ({ from, answer }) => {
      this.handleAnswer(from, answer);
    });
    
    this.socket.on('ice-candidate', ({ from, candidate }) => {
      this.handleIceCandidate(from, candidate);
    });
    
    // 5. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº ÑƒĞ¶Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ñ‘Ğ½Ğ½Ñ‹Ñ… ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²
    const response = await fetch(`/api/rooms/${roomId}/participants`, {
      headers: { 'Authorization': `Bearer ${token}` }
    });
    const { participants } = await response.json();
    
    // 6. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ P2P ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ Ñ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¼
    participants.forEach(participant => {
      if (participant.id !== currentUserId) {
        this.createPeerConnection(participant.id, true);
      }
    });
  }
  
  private createPeerConnection(userId: number, isInitiator: boolean) {
    // STUN/TURN ÑĞµÑ€Ğ²ĞµÑ€Ñ‹ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ±Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ NAT
    const configuration = {
      iceServers: [
        { urls: 'stun:stun.l.google.com:19302' },
        { urls: 'stun:stun1.l.google.com:19302' },
        // TURN ÑĞµÑ€Ğ²ĞµÑ€ Ğ´Ğ»Ñ ÑĞ»ÑƒÑ‡Ğ°ĞµĞ² ĞºĞ¾Ğ³Ğ´Ğ° P2P Ğ½ĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½
        {
          urls: 'turn:your-turn-server.com:3478',
          username: 'user',
          credential: 'pass'
        }
      ]
    };
    
    const peer = new RTCPeerConnection(configuration);
    
    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°ÑƒĞ´Ğ¸Ğ¾ Ğ¿Ğ¾Ñ‚Ğ¾Ğº
    if (this.localStream) {
      this.localStream.getTracks().forEach(track => {
        peer.addTrack(track, this.localStream!);
      });
    }
    
    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°
    peer.ontrack = (event) => {
      const remoteStream = event.streams[0];
      this.playRemoteAudio(userId, remoteStream);
    };
    
    // ICE ĞºĞ°Ğ½Ğ´Ğ¸Ğ´Ğ°Ñ‚Ñ‹
    peer.onicecandidate = (event) => {
      if (event.candidate) {
        this.socket.emit('ice-candidate', {
          to: userId,
          candidate: event.candidate
        });
      }
    };
    
    // ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
    peer.oniceconnectionstatechange = () => {
      console.log(`Connection state with ${userId}:`, peer.iceConnectionState);
      
      if (peer.iceConnectionState === 'disconnected' || 
          peer.iceConnectionState === 'failed') {
        // ĞŸĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
        this.reconnect(userId);
      }
    };
    
    this.peers.set(userId, peer);
    
    // Ğ•ÑĞ»Ğ¸ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ñ‚Ğ¾Ñ€ - ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ offer
    if (isInitiator) {
      this.createOffer(userId);
    }
  }
  
  private async createOffer(userId: number) {
    const peer = this.peers.get(userId);
    if (!peer) return;
    
    const offer = await peer.createOffer();
    await peer.setLocalDescription(offer);
    
    this.socket.emit('webrtc-offer', {
      to: userId,
      offer: offer
    });
  }
  
  private async handleOffer(userId: number, offer: RTCSessionDescriptionInit) {
    let peer = this.peers.get(userId);
    
    if (!peer) {
      this.createPeerConnection(userId, false);
      peer = this.peers.get(userId)!;
    }
    
    await peer.setRemoteDescription(new RTCSessionDescription(offer));
    
    const answer = await peer.createAnswer();
    await peer.setLocalDescription(answer);
    
    this.socket.emit('webrtc-answer', {
      to: userId,
      answer: answer
    });
  }
  
  private async handleAnswer(userId: number, answer: RTCSessionDescriptionInit) {
    const peer = this.peers.get(userId);
    if (!peer) return;
    
    await peer.setRemoteDescription(new RTCSessionDescription(answer));
  }
  
  private async handleIceCandidate(userId: number, candidate: RTCIceCandidateInit) {
    const peer = this.peers.get(userId);
    if (!peer) return;
    
    await peer.addIceCandidate(new RTCIceCandidate(candidate));
  }
  
  private playRemoteAudio(userId: number, stream: MediaStream) {
    // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ audio ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸Ñ
    let audio = document.getElementById(`audio-${userId}`) as HTMLAudioElement;
    
    if (!audio) {
      audio = document.createElement('audio');
      audio.id = `audio-${userId}`;
      audio.autoplay = true;
      document.body.appendChild(audio);
    }
    
    audio.srcObject = stream;
  }
  
  leaveVoiceChat() {
    // ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº
    this.localStream?.getTracks().forEach(track => track.stop());
    
    // Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ²ÑĞµ P2P ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
    this.peers.forEach(peer => peer.close());
    this.peers.clear();
    
    // Ğ’Ñ‹Ğ¹Ñ‚Ğ¸ Ğ¸Ğ· Socket.IO ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹
    this.socket.emit('leave-room', this.currentRoomId);
  }
}
```

### 3. Ğ”ĞµÑ‚ĞµĞºÑ†Ğ¸ï¿½ï¿½ Ğ³Ğ¾Ğ²Ğ¾Ñ€ÑÑ‰ĞµĞ³Ğ¾

**Ğ›Ğ¾Ğ³Ğ¸ĞºĞ°:**

```typescript
class SpeakingDetector {
  private audioContext: AudioContext;
  private analyser: AnalyserNode;
  private isSpeaking: boolean = false;
  
  constructor(stream: MediaStream) {
    this.audioContext = new AudioContext();
    this.analyser = this.audioContext.createAnalyser();
    
    const source = this.audioContext.createMediaStreamSource(stream);
    source.connect(this.analyser);
    
    this.analyser.fftSize = 256;
    this.detect();
  }
  
  private detect() {
    const dataArray = new Uint8Array(this.analyser.frequencyBinCount);
    
    const checkLevel = () => {
      this.analyser.getByteFrequencyData(dataArray);
      
      // Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ·Ğ²ÑƒĞºĞ°
      const average = dataArray.reduce((a, b) => a + b) / dataArray.length;
      
      // ĞŸĞ¾Ñ€Ğ¾Ğ³ Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ñ€ĞµÑ‡Ğ¸
      const SPEAKING_THRESHOLD = 30;
      const currentlySpeaking = average > SPEAKING_THRESHOLD;
      
      // Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»ÑÑ Ğ»Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑ?
      if (currentlySpeaking !== this.isSpeaking) {
        this.isSpeaking = currentlySpeaking;
        
        // Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ ÑĞµÑ€Ğ²ĞµÑ€
        socket.emit(
          currentlySpeaking ? 'start-speaking' : 'stop-speaking',
          { roomId: this.roomId }
        );
      }
      
      requestAnimationFrame(checkLevel);
    };
    
    checkLevel();
  }
}
```

**Backend broadcast:**

```javascript
socket.on('start-speaking', ({ roomId }) => {
  socket.to(`room-${roomId}`).emit('user-speaking', {
    userId: socket.userId,
    isSpeaking: true
  });
});

socket.on('stop-speaking', ({ roomId }) => {
  socket.to(`room-${roomId}`).emit('user-speaking', {
    userId: socket.userId,
    isSpeaking: false
  });
});
```

---

## ğŸ’¬ Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ñ‡Ğ°Ñ‚

### 1. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ

**Flow:**

```
User                      Frontend              Backend              Database              Other Users
  â”‚                          â”‚                     â”‚                     â”‚                        â”‚
  â”‚ 1. Ğ’Ğ²Ğ¾Ğ´ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ² Ğ¿Ğ¾Ğ»Ğµ    â”‚                     â”‚                     â”‚                        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚                        â”‚
  â”‚                          â”‚                     â”‚                     â”‚                        â”‚
  â”‚ 2. Enter Ğ¸Ğ»Ğ¸ ĞºĞ»Ğ¸Ğº        â”‚                     â”‚                     â”‚                        â”‚
  â”‚    "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ"           â”‚                     â”‚                     â”‚                        â”‚
  â”œâ”€â”€â”€â”€â”€ï¿½ï¿½ï¿½â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                     â”‚                        â”‚
  â”‚                          â”‚                     â”‚                     â”‚                        â”‚
  â”‚                          â”‚ 3. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ:       â”‚                     â”‚                        â”‚
  â”‚                          â”‚    - ĞĞµ Ğ¿ÑƒÑÑ‚Ğ¾Ğµ      â”‚                     â”‚                        â”‚
  â”‚                          â”‚    - ĞœĞ°ĞºÑ. 2000 ÑĞ¸Ğ¼Ğ²â”‚                     â”‚                        â”‚
  â”‚                          â”‚                     â”‚                     â”‚                        â”‚
  â”‚                          â”‚ 4. socket.emit      â”‚                     â”‚                        â”‚
  â”‚                          â”‚    'send-message'   â”‚                     â”‚                        â”‚
  â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                        â”‚
  â”‚                          â”‚                     â”‚                     â”‚                        â”‚
  â”‚                          â”‚                     â”‚ 5. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° â”‚                        â”‚
  â”‚                          â”‚                     â”‚    Ğº ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğµ        â”‚                        â”‚
  â”‚                          â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
  â”‚                          â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
  â”‚                          â”‚                     â”‚                     â”‚                        â”‚
  â”‚                          â”‚                     â”‚ 6. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ       â”‚                        â”‚
  â”‚                          â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
  â”‚                          â”‚                     â”‚ INSERT INTO messagesâ”‚                        â”‚
  â”‚                          â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
  â”‚                          â”‚                     â”‚ (id, content, timestamp)                     â”‚
  â”‚                          â”‚                     â”‚                     â”‚                        â”‚
  â”‚                          â”‚                     â”‚ 7. io.to(room)      â”‚                        â”‚
  â”‚                          â”‚                     â”‚    .emit('new-message')                      â”‚
  â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                          â”‚                     â”‚                     â”‚                        â”‚
  â”‚ 8. Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµÑ‚ÑÑâ”‚                     â”‚                     â”‚ 9. Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾  â”‚
  â”‚    Ğ² Ñ‡Ğ°Ñ‚Ğµ                â”‚                     â”‚                     â”‚                        â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚                     â”‚                        â”‚
```

### 2. Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹

**ĞŸÑ€Ğ¸ Ğ²Ñ…Ğ¾Ğ´Ğµ Ğ² ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ:**

```typescript
const loadMessages = async (roomId: number) => {
  // ĞŸĞ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ: Ğ¿Ğ¾ 50 ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
  const response = await fetch(
    `/api/messages?roomId=${roomId}&limit=50&offset=0`,
    { headers: { 'Authorization': `Bearer ${token}` } }
  );
  
  const { messages } = await response.json();
  setMessages(messages);
  
  // ĞŸÑ€Ğ¾ĞºÑ€ÑƒÑ‚Ğ¸Ñ‚ÑŒ Ğ²Ğ½Ğ¸Ğ·
  chatRef.current?.scrollTo(0, chatRef.current.scrollHeight);
};

// Ğ‘ĞµÑĞºĞ¾Ğ½ĞµÑ‡Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾ĞºÑ€ÑƒÑ‚ĞºĞ° Ğ²Ğ²ĞµÑ€Ñ… (Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ÑÑ‚Ğ°Ñ€Ñ‹Ñ…)
const loadMoreMessages = async () => {
  if (isLoading) return;
  
  setIsLoading(true);
  
  const response = await fetch(
    `/api/messages?roomId=${roomId}&limit=50&offset=${messages.length}`,
    { headers: { 'Authorization': `Bearer ${token}` } }
  );
  
  const { messages: olderMessages } = await response.json();
  
  setMessages(prev => [...olderMessages, ...prev]);
  setIsLoading(false);
};

// Ğ¡Ğ»ÑƒÑˆĞ°Ñ‚ÑŒ ÑĞºÑ€Ğ¾Ğ»Ğ»
useEffect(() => {
  const handleScroll = () => {
    if (chatRef.current?.scrollTop === 0) {
      loadMoreMessages();
    }
  };
  
  chatRef.current?.addEventListener('scroll', handleScroll);
  return () => chatRef.current?.removeEventListener('scroll', handleScroll);
}, []);
```

### 3. ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹

**Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸:**

```typescript
const groupMessagesByTime = (messages: Message[]) => {
  const groups: { date: string; messages: Message[] }[] = [];
  
  messages.forEach(msg => {
    const date = new Date(msg.timestamp).toLocaleDateString();
    
    const existingGroup = groups.find(g => g.date === date);
    
    if (existingGroup) {
      existingGroup.messages.push(msg);
    } else {
      groups.push({ date, messages: [msg] });
    }
  });
  
  return groups;
};

// Ğ ĞµĞ½Ğ´ĞµÑ€
{groupedMessages.map(group => (
  <div key={group.date}>
    <div className="text-center text-sm text-muted-foreground my-4">
      {formatDate(group.date)}
    </div>
    
    {group.messages.map(msg => (
      <MessageBubble 
        key={msg.id} 
        message={msg}
        isOwn={msg.sender.id === currentUser.id}
      />
    ))}
  </div>
))}
```

**Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ¾Ñ‚ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ:**

```typescript
const shouldShowAvatar = (msg: Message, prevMsg?: Message) => {
  if (!prevMsg) return true;
  
  // Ğ Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ĞµĞ»Ğ¸
  if (msg.sender.id !== prevMsg.sender.id) return true;
  
  // Ğ‘Ğ¾Ğ»ÑŒÑˆĞµ 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ÑĞ¼Ğ¸
  const timeDiff = new Date(msg.timestamp).getTime() - 
                   new Date(prevMsg.timestamp).getTime();
  if (timeDiff > 5 * 60 * 1000) return true;
  
  return false;
};
```

---

## ğŸŸ¢ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹

### 1. Ğ¢Ğ¸Ğ¿Ñ‹ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ¾Ğ²

```typescript
type UserStatus = 
  | 'online'   // ĞĞ½Ğ»Ğ°Ğ¹Ğ½ Ğ¸ Ğ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½
  | 'away'     // ĞÑ‚Ğ¾ÑˆÑ‘Ğ» (Ğ½ĞµĞ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½ >10 Ğ¼Ğ¸Ğ½ÑƒÑ‚)
  | 'busy'     // Ğ—Ğ°Ğ½ÑÑ‚ (Ğ² Ğ·Ğ²Ğ¾Ğ½ĞºĞµ Ğ¸Ğ»Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾ Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ)
  | 'offline'; // ĞÑ„Ğ»Ğ°Ğ¹Ğ½
```

### 2. ĞšĞ°Ğº Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑÑÑ‚ÑÑ ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹

**ĞŸÑ€Ğ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸:**

```typescript
// Frontend
socket.on('connect', () => {
  // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑÑ online
  socket.emit('status-change', { status: 'online' });
});

// Backend
socket.on('status-change', async ({ status }) => {
  const userId = socket.userId;
  
  // ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ² Ğ±Ğ°Ğ·Ğµ
  await db.query(
    'UPDATE users SET status = $1, updated_at = NOW() WHERE id = $2',
    [status, userId]
  );
  
  // Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ Ğ²ÑĞµÑ… Ğ´Ñ€ÑƒĞ·ĞµĞ¹
  const friends = await getFriendIds(userId);
  
  friends.forEach(friendId => {
    io.to(friendId).emit('friend-status-changed', {
      userId: userId,
      status: status
    });
  });
});
```

**ĞŸÑ€Ğ¸ Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸:**

```typescript
socket.on('disconnect', async () => {
  const userId = socket.userId;
  
  // Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ offline
  await db.query(
    'UPDATE users SET status = $1, updated_at = NOW() WHERE id = $2',
    ['offline', userId]
  );
  
  // Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ·ĞµĞ¹
  const friends = await getFriendIds(userId);
  
  friends.forEach(friendId => {
    io.to(friendId).emit('friend-status-changed', {
      userId: userId,
      status: 'offline'
    });
  });
});
```

**ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ "away" Ğ¿Ñ€Ğ¸ Ğ½ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸:**

```typescript
// Frontend
let inactivityTimer: NodeJS.Timeout;

const resetInactivityTimer = () => {
  clearTimeout(inactivityTimer);
  
  // Ğ•ÑĞ»Ğ¸ Ğ±Ñ‹Ğ» away, Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒÑÑ Ğ² online
  if (currentStatus === 'away') {
    socket.emit('status-change', { status: 'online' });
    setCurrentStatus('online');
  }
  
  // Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€ Ğ½Ğ° 10 Ğ¼Ğ¸Ğ½ÑƒÑ‚
  inactivityTimer = setTimeout(() => {
    socket.emit('status-change', { status: 'away' });
    setCurrentStatus('away');
  }, 10 * 60 * 1000);
};

// Ğ¡Ğ»ÑƒÑˆĞ°Ñ‚ÑŒ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ
useEffect(() => {
  window.addEventListener('mousemove', resetInactivityTimer);
  window.addEventListener('keypress', resetInactivityTimer);
  window.addEventListener('click', resetInactivityTimer);
  
  resetInactivityTimer();
  
  return () => {
    window.removeEventListener('mousemove', resetInactivityTimer);
    window.removeEventListener('keypress', resetInactivityTimer);
    window.removeEventListener('click', resetInactivityTimer);
  };
}, []);
```

### 3. Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ

```typescript
const getStatusColor = (status: UserStatus) => {
  switch (status) {
    case 'online':
      return 'bg-green-500';
    case 'away':
      return 'bg-yellow-500';
    case 'busy':
      return 'bg-red-500';
    case 'offline':
      return 'bg-gray-500';
  }
};

const StatusIndicator = ({ status }: { status: UserStatus }) => (
  <div className="relative">
    <div className={`w-3 h-3 rounded-full ${getStatusColor(status)}`} />
    
    {status === 'online' && (
      <div className="absolute inset-0 w-3 h-3 rounded-full bg-green-500 animate-ping opacity-75" />
    )}
  </div>
);
```

---

## ğŸ“ Ğ—Ğ²Ğ¾Ğ½ĞºĞ¸

### 1. Ğ›Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ·Ğ²Ğ¾Ğ½Ğ¾Ğº (1-Ğ½Ğ°-1)

**Flow:**

```
User A                    Frontend A              Backend              Frontend B            User B
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚ 1. ĞšĞ»Ğ¸Ğº Ğ½Ğ° Ğ´Ñ€ÑƒĞ³Ğ°         â”‚                       â”‚                      â”‚                   â”‚
  â”‚    â†’ "ĞŸĞ¾Ğ·Ğ²Ğ¾Ğ½Ğ¸Ñ‚ÑŒ"         â”‚                       â”‚                      â”‚                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚ 2. POST /api/rooms    â”‚                      â”‚                   â”‚
  â”‚                          â”‚    (ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½ÑƒÑ â”‚                      â”‚                   â”‚
  â”‚                          â”‚     ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ Ğ´Ğ»Ñ 2Ñ…)   â”‚                      â”‚                   â”‚
  â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚ 3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ   â”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚                   â”‚
  â”‚                          â”‚ { roomId }            â”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚ 4. socket.emit        â”‚                      â”‚                   â”‚
  â”‚                          â”‚    'call-friend'      â”‚                      â”‚                   â”‚
  â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚ 5. socket.to(B)      â”‚                   â”‚
  â”‚                          â”‚                       â”‚    .emit('incoming-call')                â”‚
  â”‚                          â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚ 6. ĞœĞ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ â”‚
  â”‚                          â”‚                       â”‚                      â”‚    "Ğ’Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğ¹      â”‚
  â”‚                          â”‚                       â”‚                      â”‚     Ğ·Ğ²Ğ¾Ğ½Ğ¾Ğº Ğ¾Ñ‚ A"  â”‚
  â”‚                          â”‚                       â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚ 7a. ĞŸÑ€Ğ¸Ğ½ÑÑ‚ÑŒ       â”‚
  â”‚                          â”‚                       â”‚                      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚ 8. socket.emit       â”‚                   â”‚
  â”‚                          â”‚                       â”‚    'accept-call'     â”‚                   ï¿½ï¿½
  â”‚                          â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚ 9. 'call-accepted'    â”‚                      â”‚                   â”‚
  â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚ 10. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° WebRTC  â”‚                      â”‚ 11. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°     â”‚
  â”‚                          â”‚     ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ        â”‚                      â”‚     WebRTC        â”‚
  â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚ 12. Ğ˜Ğ´Ñ‘Ñ‚ Ğ·Ğ²Ğ¾Ğ½Ğ¾Ğº          â”‚                       â”‚                      â”‚ 13. Ğ˜Ğ´Ñ‘Ñ‚ Ğ·Ğ²Ğ¾Ğ½Ğ¾Ğº   â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
```

**Ğ˜Ğ»Ğ¸ Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğµ:**

```
  â”‚                          â”‚                       â”‚                      â”‚ 7b. ĞÑ‚ĞºĞ»Ğ¾Ğ½Ğ¸Ñ‚ÑŒ     â”‚
  â”‚                          â”‚                       â”‚                      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚ 8b. socket.emit      â”‚                   â”‚
  â”‚                          â”‚                       â”‚     'decline-call'   â”‚                   â”‚
  â”‚                          â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚                          â”‚ 9b. 'call-declined'   â”‚                      â”‚                   â”‚
  â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚                   â”‚
  â”‚                          â”‚                       â”‚                      â”‚                   â”‚
  â”‚ 10b. "User B Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½Ğ¸Ğ»"   â”‚                       â”‚                      â”‚                   â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚                      â”‚                   â”‚
```

### 2. Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¾Ğ²Ğ¾Ğ¹ Ğ·Ğ²Ğ¾Ğ½Ğ¾Ğº (ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ°)

**Flow:**

```
User A (Owner)            Frontend              Backend
  â”‚                          â”‚                     â”‚
  â”‚ 1. "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ"     â”‚                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
  â”‚                          â”‚                     â”‚
  â”‚ 2. Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ´Ñ€ÑƒĞ·ĞµĞ¹ Ğ´Ğ»Ñ      â”‚                     â”‚
  â”‚    Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ñ           â”‚                     â”‚
  â”‚                          â”‚                     â”‚
  â”‚ 3. POST /api/rooms       â”‚                     â”‚
  â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                          â”‚                     â”‚
  â”‚                          â”‚                     â”‚ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹
  â”‚                          â”‚                     â”‚ ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ğµ Ğ´Ñ€ÑƒĞ·ĞµĞ¹
  â”‚                          â”‚                     â”‚
  â”‚                          â”‚                     â”‚ WebSocket:
  â”‚                          â”‚                     â”‚ â†’ Friend 1: Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ğµ
  â”‚                          â”‚                     â”‚ â†’ Friend 2: Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ğµ
  â”‚                          â”‚                     â”‚ â†’ Friend 3: Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ğµ
  â”‚                          â”‚                     â”‚
  â”‚ 4. ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ²Ñ…Ğ¾Ğ´   â”‚                     â”‚
  â”‚    Ğ² ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ             â”‚                     â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
```

**Ğ”Ñ€ÑƒĞ·ÑŒÑ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ÑÑ‚ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ğµ:**

```
Friend 1                  Frontend              Backend
  â”‚                          â”‚                     â”‚
  â”‚ 1. WebSocket:            â”‚                     â”‚
  â”‚    'room-invitation'     â”‚                     â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
  â”‚                          â”‚                     â”‚
  â”‚ 2. Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ:          â”‚                     â”‚
  â”‚    "A Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ» Ğ²        â”‚                     â”‚
  â”‚     ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ 'Ğ˜Ğ³Ñ€Ñ‹'"      â”‚                     â”‚
  â”‚                          â”‚                     â”‚
  â”‚ 3. ĞšĞ»Ğ¸Ğº "ĞŸÑ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒÑÑ" â”‚                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
  â”‚                          â”‚                     â”‚
  â”‚                          â”‚ POST /api/rooms/:id/join
  â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                          â”‚                     â”‚
  â”‚                          â”‚                     â”‚ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ² ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¸
  â”‚                          â”‚                     â”‚
  â”‚ 4. Ğ’Ñ…Ğ¾Ğ´ Ğ² ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñƒ        â”‚                     â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
```

---

## ğŸ”” Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ

### 1. Ğ¢Ğ¸Ğ¿Ñ‹ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹

```typescript
type Notification = 
  | FriendRequestNotification
  | RoomInvitationNotification
  | IncomingCallNotification
  | MissedCallNotification
  | MessageNotification;

interface FriendRequestNotification {
  type: 'friend-request';
  from: User;
  timestamp: Date;
}

interface RoomInvitationNotification {
  type: 'room-invitation';
  from: User;
  room: Room;
  timestamp: Date;
}

interface IncomingCallNotification {
  type: 'incoming-call';
  from: User;
  room: Room;
  timestamp: Date;
}

interface MissedCallNotification {
  type: 'missed-call';
  from: User;
  timestamp: Date;
}

interface MessageNotification {
  type: 'message';
  from: User;
  room: Room;
  message: string;
  timestamp: Date;
}
```

### 2. Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹

**Backend Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ°:**

```javascript
const sendNotification = async (userId, notification) => {
  // 1. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ² Ğ±Ğ°Ğ·Ñƒ
  await db.query(
    `INSERT INTO notifications (user_id, type, data, is_read)
     VALUES ($1, $2, $3, $4)`,
    [userId, notification.type, JSON.stringify(notification), false]
  );
  
  // 2. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· WebSocket ĞµÑĞ»Ğ¸ Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½
  io.to(userId).emit('notification', notification);
  
  // 3. Push notification ĞµÑĞ»Ğ¸ Ğ¾Ñ„Ğ»Ğ°Ğ¹Ğ½ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
  const user = await getUser(userId);
  if (user.status === 'offline' && user.pushToken) {
    await sendPushNotification(user.pushToken, notification);
  }
};
```

**Frontend Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°:**

```typescript
useEffect(() => {
  socket.on('notification', (notification) => {
    // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ toast
    toast.info(formatNotification(notification), {
      action: {
        label: 'ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ',
        onClick: () => handleNotificationClick(notification)
      }
    });
    
    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² ÑĞ¿Ğ¸ÑĞ¾Ğº ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹
    setNotifications(prev => [notification, ...prev]);
    
    // Ğ’Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸ï¿½ï¿½Ğ²ĞµÑÑ‚Ğ¸ Ğ·Ğ²ÑƒĞº
    playNotificationSound(notification.type);
    
    // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ½Ğ¾Ğµ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ ĞµÑĞ»Ğ¸ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ° Ğ½Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ°
    if (document.hidden) {
      showBrowserNotification(notification);
    }
  });
}, []);

const showBrowserNotification = (notification) => {
  if ('Notification' in window && Notification.permission === 'granted') {
    new Notification('WOXLY', {
      body: formatNotification(notification),
      icon: '/logo.png',
      badge: '/badge.png'
    });
  }
};
```

### 3. Ğ—Ğ²ÑƒĞºĞ¸ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹

```typescript
const SOUNDS = {
  'friend-request': '/sounds/friend-request.mp3',
  'room-invitation': '/sounds/room-invitation.mp3',
  'incoming-call': '/sounds/incoming-call.mp3',
  'message': '/sounds/message.mp3'
};

const playNotificationSound = (type: string) => {
  const audio = new Audio(SOUNDS[type]);
  audio.volume = 0.5;
  audio.play().catch(err => {
    console.log('ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ¸ Ğ·Ğ²ÑƒĞº:', err);
  });
};
```

---

## ğŸ›ï¸ ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ

### 1. ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ¸ Ğ¸Ñ… Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸

**ĞœĞ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½ (Ğ²ĞºĞ»/Ğ²Ñ‹ĞºĞ»):**

```typescript
const toggleMicrophone = () => {
  if (!localStream) return;
  
  const audioTrack = localStream.getAudioTracks()[0];
  
  if (audioTrack) {
    audioTrack.enabled = !audioTrack.enabled;
    setIsMicrophoneMuted(!audioTrack.enabled);
    
    // Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ…
    socket.emit('mic-toggle', {
      roomId: currentRoomId,
      isMuted: !audioTrack.enabled
    });
  }
};
```

**ĞĞ°ÑƒÑˆĞ½Ğ¸ĞºĞ¸ (Ğ²ĞºĞ»/Ğ²Ñ‹ĞºĞ» Ğ·Ğ²ÑƒĞº Ğ¾Ñ‚ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ…):**

```typescript
const toggleDeafen = () => {
  const newDeafenState = !isDeafened;
  setIsDeafened(newDeafenState);
  
  // Ğ—Ğ°Ğ³Ğ»ÑƒÑˆĞ¸Ñ‚ÑŒ Ğ²ÑĞµ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ°ÑƒĞ´Ğ¸Ğ¾
  Object.values(remoteAudioElements).forEach(audio => {
    audio.muted = newDeafenState;
  });
  
  // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ mute Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½ Ğ¿Ñ€Ğ¸ deafen
  if (newDeafenState && !isMicrophoneMuted) {
    toggleMicrophone();
  }
  
  socket.emit('deafen-toggle', {
    roomId: currentRoomId,
    isDeafened: newDeafenState
  });
};
```

**ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸:**

```typescript
const openSettings = () => {
  setShowSettingsModal(true);
};

// Ğ’ Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ¾ĞºĞ½Ğµ:
// - Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½Ğ°
// - Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸ĞºĞ¾Ğ²
// - Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚ÑŒ Ğ²Ñ…Ğ¾Ğ´Ğ°
// - Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚ÑŒ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ°
// - Ğ¢ĞµÑÑ‚ Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½Ğ°
```

**Ğ’Ñ‹Ñ…Ğ¾Ğ´ Ğ¸Ğ· ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹:**

```typescript
const leaveRoom = () => {
  // 1. ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº
  localStream?.getTracks().forEach(track => track.stop());
  
  // 2. Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ P2P ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
  peers.forEach(peer => peer.close());
  peers.clear();
  
  // 3. Ğ’Ñ‹Ğ¹Ñ‚Ğ¸ Ğ¸Ğ· Socket.IO ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹
  socket.emit('leave-room', currentRoomId);
  
  // 4. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ UI
  setCurrentRoomId(null);
  setParticipants([]);
  
  // 5. ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ³Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ ÑĞºÑ€Ğ°Ğ½
  navigate('/');
};
```

### 2. Ğ ĞµĞ³ÑƒĞ»Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ³Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚Ğ¸

**Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚ÑŒ Ğ²Ñ…Ğ¾Ğ´Ğ° (Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½):**

```typescript
const setInputVolume = (volume: number) => {
  if (!localStream) return;
  
  const audioTrack = localStream.getAudioTracks()[0];
  
  // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Web Audio API Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ³Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚Ğ¸
  const audioContext = new AudioContext();
  const source = audioContext.createMediaStreamSource(localStream);
  const gainNode = audioContext.createGain();
  
  gainNode.gain.value = volume / 100; // 0 to 1
  
  source.connect(gainNode);
  
  setInputVolumeValue(volume);
};
```

**Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚ÑŒ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ° (Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸ĞºĞ¸):**

```typescript
const setOutputVolume = (volume: number) => {
  // ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ĞºĞ¾ Ğ²ÑĞµĞ¼ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½Ğ½Ñ‹Ğ¼ Ğ°ÑƒĞ´Ğ¸Ğ¾
  Object.values(remoteAudioElements).forEach(audio => {
    audio.volume = volume / 100; // 0 to 1
  });
  
  setOutputVolumeValue(volume);
  
  // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ² Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ñ…
  localStorage.setItem('outputVolume', volume.toString());
};
```

---

## ğŸ”„ Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ

### 1. ĞŸÑ€Ğ¸ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸

```typescript
socket.on('connect', async () => {
  console.log('ĞŸĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾ Ğº ÑĞµÑ€Ğ²ĞµÑ€Ñƒ');
  
  // 1. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ
  socket.emit('status-change', { status: 'online' });
  
  // 2. ĞŸĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğº ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğµ (ĞµÑĞ»Ğ¸ Ğ±Ñ‹Ğ» Ğ² Ğ½ĞµĞ¹)
  if (currentRoomId) {
    socket.emit('join-room', currentRoomId);
    
    // ĞŸĞµÑ€ĞµÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ WebRTC ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
    await reconnectVoiceChat(currentRoomId);
  }
  
  // 3. Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
  await syncData();
});

const syncData = async () => {
  // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ²ĞµĞ¶Ğ¸Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ´Ñ€ÑƒĞ·ĞµĞ¹
  const friendsResponse = await fetch('/api/friends', {
    headers: { 'Authorization': `Bearer ${token}` }
  });
  const { friends } = await friendsResponse.json();
  setFriends(friends);
  
  // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½ĞµĞ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ
  const notificationsResponse = await fetch('/api/notifications?unread=true', {
    headers: { 'Authorization': `Bearer ${token}` }
  });
  const { notifications } = await notificationsResponse.json();
  setNotifications(notifications);
};
```

### 2. ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ

```typescript
socket.on('connect_error', (error) => {
  console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ:', error);
  
  toast.error('ĞŸĞ¾Ñ‚ĞµÑ€ÑĞ½Ğ¾ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ Ñ ÑĞµÑ€Ğ²ĞµÑ€Ğ¾Ğ¼');
  
  // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¾Ğ²ĞµÑ€Ğ»ĞµĞ¹ "ĞŸĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ..."
  setIsReconnecting(true);
});

socket.on('reconnect', (attemptNumber) => {
  console.log(`ĞŸĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾ Ğ¿Ğ¾ÑĞ»Ğµ ${attemptNumber} Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº`);
  
  toast.success('Ğ¡Ğ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾');
  setIsReconnecting(false);
  
  syncData();
});

socket.on('reconnect_failed', () => {
  toast.error('ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒÑÑ. ĞŸĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚Ğµ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ.');
  
  setIsReconnecting(false);
  setIsOffline(true);
});
```

---

## ğŸ“Š Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ°Ñ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER ACTIONS                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   React UI   â”‚  â”‚ State Managerâ”‚  â”‚ WebRTC Peer  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                 â”‚                  â”‚                      â”‚
â”‚         â–¼                 â–¼                  â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚           Socket.IO Client                       â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ WebSocket
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BACKEND                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚           Socket.IO Server                       â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                 â”‚                 â”‚                                 â”‚
â”‚                 â–¼                 â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚   REST API       â”‚  â”‚  WebRTC Signal   â”‚                        â”‚
â”‚  â”‚   Server         â”‚  â”‚  Server          â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                 â”‚                                                   â”‚
â”‚                 â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚           PostgreSQL Database                    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ P2P Voice
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              WebRTC P2P Connection (Direct)                         â”‚
â”‚                                                                      â”‚
â”‚  User A  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Voice/Audio â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  User B         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾! Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ²Ñ‹ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚Ğµ ĞºĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ ĞºĞ°Ğ¶Ğ´Ğ°Ñ Ñ‡Ğ°ÑÑ‚ÑŒ WOXLY! ğŸ‰**
