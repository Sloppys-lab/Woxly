# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## ‚úÖ –í–°–ï 19 –ó–ê–î–ê–ß –í–´–ü–û–õ–ù–ï–ù–û (100%)!

---

## üì¶ –ß—Ç–æ –Ω—É–∂–Ω–æ –∑–∞–∫–∏–Ω—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### 1. Backend —Ñ–∞–π–ª—ã (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ)

```bash
# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@woxly.ru

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é backend
cd /var/www/woxly.ru/apps/backend
```

**–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

1. **`src/controllers/users.ts`** - –¥–æ–±–∞–≤–ª–µ–Ω—ã Socket.IO —Å–æ–±—ã—Ç–∏—è –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π
2. **`src/controllers/messages.ts`** - –¥–æ–±–∞–≤–ª–µ–Ω—ã Socket.IO —Å–æ–±—ã—Ç–∏—è –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
3. **`src/controllers/rooms.ts`** - –¥–æ–±–∞–≤–ª–µ–Ω endpoint `createGroupRoom`
4. **`src/routes/rooms.ts`** - –¥–æ–±–∞–≤–ª–µ–Ω —Ä–æ—É—Ç `/create-group`

**–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Git (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```bash
cd /var/www/woxly.ru
git pull origin main
```

**–°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ SCP (–µ—Å–ª–∏ –Ω–µ—Ç Git)**
```powershell
# –° Windows –º–∞—à–∏–Ω—ã
scp C:\woxly\apps\backend\src\controllers\users.ts root@woxly.ru:/var/www/woxly.ru/apps/backend/src/controllers/
scp C:\woxly\apps\backend\src\controllers\messages.ts root@woxly.ru:/var/www/woxly.ru/apps/backend/src/controllers/
scp C:\woxly\apps\backend\src\controllers\rooms.ts root@woxly.ru:/var/www/woxly.ru/apps/backend/src/controllers/
scp C:\woxly\apps\backend\src\routes\rooms.ts root@woxly.ru:/var/www/woxly.ru/apps/backend/src/routes/
```

---

### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞)

**–§–∞–π–ª:** `prisma/schema.prisma`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `customRoomName` –∏ `customRoomAvatar` –≤ `RoomMember`

**–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ö–µ–º—É:**
```bash
cd /var/www/woxly.ru/apps/backend
npx prisma db push
```

**–ò–ª–∏ —á–µ—Ä–µ–∑ SCP:**
```powershell
scp C:\woxly\prisma\schema.prisma root@woxly.ru:/var/www/woxly.ru/prisma/
```

–ó–∞—Ç–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
cd /var/www/woxly.ru/apps/backend
npx prisma db push
```

---

### 3. Desktop EXE (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

**–§–∞–π–ª—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏:**
```powershell
# –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫
scp C:\woxly\apps\desktop\release\Woxly-Setup-1.0.0.exe root@woxly.ru:/var/www/woxly.ru/downloads/desktop/

# –§–∞–π–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
scp C:\woxly\apps\desktop\release\latest.yml root@woxly.ru:/var/www/woxly.ru/downloads/desktop/

# Blockmap –¥–ª—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
scp C:\woxly\apps\desktop\release\Woxly-Setup-1.0.0.exe.blockmap root@woxly.ru:/var/www/woxly.ru/downloads/desktop/
```

**–†–∞–∑–º–µ—Ä EXE:** ~150 MB

---

## üîß –ö–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ö–µ–º—É –ë–î
```bash
ssh root@woxly.ru
cd /var/www/woxly.ru/apps/backend
npx prisma db push
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
‚úî Generated Prisma Client
‚úî The database is now in sync with the Prisma schema.
```

---

### –®–∞–≥ 2: –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å backend
```bash
cd /var/www/woxly.ru/apps/backend
npm run build
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
> @woxly/backend@1.0.0 build
> tsc

‚úì Compiled successfully
```

---

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
```bash
pm2 restart woxly-backend
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å:**
```bash
pm2 status
pm2 logs woxly-backend --lines 50
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id  ‚îÇ name           ‚îÇ mode    ‚îÇ status  ‚îÇ cpu      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0   ‚îÇ woxly-backend  ‚îÇ fork    ‚îÇ online  ‚îÇ 0%       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

üöÄ Server running on 0.0.0.0:3001
```

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É API
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint
curl http://localhost:3001/api/health

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
# {"status":"ok"}
```

---

## üìù –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

### Backend
- [ ] –§–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã (users.ts, messages.ts, rooms.ts, routes/rooms.ts)
- [ ] –°—Ö–µ–º–∞ –ë–î –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ (`npx prisma db push`)
- [ ] Backend –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω (`npm run build`)
- [ ] Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω (`pm2 restart`)
- [ ] –õ–æ–≥–∏ –±–µ–∑ –æ—à–∏–±–æ–∫ (`pm2 logs`)
- [ ] Health check —Ä–∞–±–æ—Ç–∞–µ—Ç

### Desktop EXE
- [ ] EXE –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] latest.yml –∑–∞–≥—Ä—É–∂–µ–Ω
- [ ] blockmap –∑–∞–≥—Ä—É–∂–µ–Ω
- [ ] –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (chmod 644)
- [ ] Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–∑–¥–∞—á–∏ —Ñ–∞–π–ª–æ–≤

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–æ–±–∞–≤–ª–µ–Ω—ã (customRoomName, customRoomAvatar)
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] Prisma Client —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω

---

## üéØ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 1. –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –¢–µ–ø–µ—Ä—å –≤–∏–¥–Ω—ã –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- Socket.IO —Å–æ–±—ã—Ç–∏–µ `new-message`

### 2. –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π
- –ê–≤–∞—Ç–∞—Ä –∏ –Ω–∏–∫ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —É –≤—Å–µ—Ö –¥—Ä—É–∑–µ–π
- Socket.IO —Å–æ–±—ã—Ç–∏–µ `friend-profile-updated`

### 3. –°–∏—Å—Ç–µ–º–∞ –∑–≤–æ–Ω–∫–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ –∑–≤–æ–Ω–æ–∫
- –ü—É–ª—å—Å–∞—Ü–∏—è –∏–∫–æ–Ω–æ–∫ –ø—Ä–∏ –∑–≤–æ–Ω–∫–µ
- –ò–∫–æ–Ω–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏
- –¢–∞–π–º–∞—É—Ç 15 –º–∏–Ω—É—Ç

### 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–∑–µ–π –≤ –∑–≤–æ–Ω–æ–∫
- –ù–æ–≤—ã–π endpoint `/rooms/create-group`
- –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø–æ–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã
- –î–æ–∑–≤–æ–Ω –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω—ã–º
- –ü–µ—Ä–µ–Ω–æ—Å –∑–≤–æ–Ω–∫–∞

### 5. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å email
- –£–±—Ä–∞–Ω userTag (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è)
- –£—Å–ª–æ–∂–Ω–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å
- 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –Ω–∞ email

### 6. UI —É–ª—É—á—à–µ–Ω–∏—è
- –ö—Ä–∞—Å–Ω—ã–µ –∞–∫—Ü–µ–Ω—Ç—ã (#DC143C)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–∞–º –≤ —á–∞—Ç–µ
- –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥—Ä—É–∑–µ–π (–ª–æ–∫–∞–ª—å–Ω–æ)
- –°—á–µ—Ç—á–∏–∫–∏ –æ–Ω–ª–∞–π–Ω/–≤—Å–µ–≥–æ

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### 1. Prisma Schema
**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –≤—ã–ø–æ–ª–Ω–∏—Ç—å `npx prisma db push` –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º backend!

–ë–µ–∑ —ç—Ç–æ–≥–æ –±—É–¥—É—Ç –æ—à–∏–±–∫–∏:
```
Error: Unknown field `customRoomName` in RoomMember
```

### 2. Socket.IO —Å–æ–±—ã—Ç–∏—è
Backend —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è:
- `friend-profile-updated` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –¥—Ä—É–≥–∞
- `new-message` - –¥–ª—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∏ —Ñ–∞–π–ª–æ–≤
- `incoming-call` - –¥–ª—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö –∑–≤–æ–Ω–∫–æ–≤

### 3. –ù–æ–≤—ã–π endpoint
`POST /api/rooms/create-group` - —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø–æ–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```json
{
  "name": "–ì—Ä—É–ø–ø–æ–≤–æ–π –∑–≤–æ–Ω–æ–∫",
  "memberIds": [2, 3, 4],
  "currentRoomId": 1
}
```

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Prisma –æ—à–∏–±–∫–∞
```
Error: Unknown field `customRoomName`
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd /var/www/woxly.ru/apps/backend
npx prisma db push
npm run build
pm2 restart woxly-backend
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: TypeScript –æ—à–∏–±–∫–∏
```
Cannot find module '../index.js'
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd /var/www/woxly.ru/apps/backend
npm install
npm run build
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: PM2 –Ω–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```
[PM2] Process woxly-backend not found
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
pm2 start ecosystem.config.js
# –∏–ª–∏
pm2 start dist/index.js --name woxly-backend
```

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ | –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ |
|-----------|-----------------|------------|
| Backend | 4 | ~150 |
| Frontend | 8 | ~300 |
| Database | 1 | ~10 |
| **–ò—Ç–æ–≥–æ** | **13** | **~460** |

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Backend —Ä–∞–±–æ—Ç–∞–µ—Ç:**
   ```bash
   curl http://localhost:3001/api/health
   ```

2. **WebSocket —Ä–∞–±–æ—Ç–∞–µ—Ç:**
   ```bash
   curl -I http://localhost:3001/socket.io/
   ```

3. **–ù–æ–≤—ã–π endpoint –¥–æ—Å—Ç—É–ø–µ–Ω:**
   ```bash
   curl -X POST http://localhost:3001/api/rooms/create-group \
     -H "Content-Type: application/json" \
     -H "Authorization: Bearer YOUR_TOKEN" \
     -d '{"name":"Test","memberIds":[2]}'
   ```

4. **EXE –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:**
   ```bash
   curl -I https://woxly.ru/downloads/desktop/Woxly-Setup-1.0.0.exe
   ```

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:
- ‚úÖ Backend –æ–±–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ EXE –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- ‚úÖ –í—Å–µ 19 –∑–∞–¥–∞—á —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–∫–∞—á–∞—Ç—å –Ω–æ–≤—ã–π EXE –∏ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –≤—Å–µ–º–∏ –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏!** üöÄ

---

**–î–∞—Ç–∞:** 13 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É





